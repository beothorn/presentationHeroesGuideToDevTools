<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<link rel="stylesheet" href="css/bootstrap.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<style>
			#timer {
			  position: relative;
			  width: 100%;
			  height: 2px;
			  background-color: #000000
			}
			.input-group{
				padding: 5px;
				font-size: 20px;
			}
			#superSpeedForm{
				border: 9px solid #fff;
				background: #272822;
				padding: 15px;
			}
			#superVisionForm{
				margin-top: 20px;
				border: 9px solid #fff;
				background: #272822;
				padding: 15px;
			}
			#superStrengthForm{
				margin-top: 20px;
				border: 9px solid #fff;
				background: #272822;
				padding: 15px;
			}
		</style>
	</head>
	<body>
	<div id="timer"></div>
		<div class="reveal">
			<div class="slides">
				<section 
					data-name="title" 
					data-background-color="#b11818"
				>
					A hero's guide to developing with Chrome Dev Tools
					<img src="qrcode.png" />
				</section>
				<section 
					data-name="introduction" 
					data-expected-duration="1m" 
					data-background-color="#26bd26"
				>
					Hi, I like to develop software
					<!--
						Present myself
						Outline the subject of the presentation
					-->
				</section>
				<section 
					data-expected-duration="30s" 
					data-background-color="#2222b9"
				>
					Everything is fine when everything is fine
					<!--
						When you follow the common practice of our industry, most of the time things are fine.
						We have unit tests to protect us, we have functional tests, we do QA, smoke tests and all of those let us sleep at night.
						Even when we deploy, we can do it in a way that if we realize something went wrong we can go back.
						When everything is fine, everything is fine.
					-->
				</section>
				<section 
					data-expected-duration="2m"
					data-background-color="#dede38"
				>
					The Evil bug
					<!--
						But sometimes everything looks fine, until it isn't. 
						Sometimes things goes weird and it is hard to understand what is going on.
						And where you start looking to solve these issues? 
					-->
				</section>
				<section 
					data-expected-duration="2m"
					data-background-color="#c332c3"
				>
					When you are in a bad situation, what can help you
					<!--
						When this happens, it is good to have all the help you can get. 
						Access to the db, logs, remote debugging, directly connecting to your server.
						Those all work but it is hard to decide where to start.
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#2222b9"
				>
					<p>As you fail you learn</p>
					<p>The obvious is powerful</p>
					<p>Small gains add up to a big gain</p>
					<!--
						Every issue is diferent, but the starting point is doing a sanity check.

						Is the basic stuff in order?

						You can reach a big chunck of the errors just doing basic checks.

						You can learn things to check by investigating new errors.

						I used to use postman and other rest clients to look at this information. 
						But they are not powerful enough. It is complicated to filter information,
						no mechanism to do complex stuff as reusing data from one query to the other.

						No output but jsons.

						A lot of copying, pasting and text searching

						You need to fail a lot. Learn what are the starting points
						to investigate issues and then create the tools for you to easily access them.
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#36bbbb"
				>
					A familiar tool that is more powerful than you thought
					<!--
						But I want to show you an unlikely help.
						I has the advantage of being a powerfull REPL, with lots of powerful features,
						flexible and being the very thing your users have to use your system.
					-->
				</section>
				<section
					data-expected-duration="10s" 
					data-background-color="#b11818"
				>
					Surprise, we're in a browser
					<!--
						For example, here we are, right now inside a browser. And I'll demonstrate to you
						that with some preparation, it can give you an edge when you need to investigate that nasty bug.

						First let me show you that chrome can show you
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#2222b9"
				>
					<p>Let's give ourselves superpowers using extensions</p>
					<p>All you need is a manifest.json file</p>
					<pre><code data-trim>
					{
						"name": "Getting Started Example",
						"version": "1.0",
						"description": "Build an Extension!",
						"manifest_version": 2
						"content_scripts": [
							{
								"matches": ["yourUrl"], 
								"js": ["inject.js"]
							}
						],
						"permissions": ["yourUrl"],
					}
					</code></pre>
					<p>Then go to chrome://extensions > load unpacked</p>
					<!--
						Dev tools is a powerfull REPL. It can render tables. It can render images.
						It can do requests using the fetch api
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#26bd26"
				>
					Super-speed
					<!--
						You need to be able to just start calling endpoints.
						Learn the fetch api.
						Use the mutation observer to inject buttons that fills boilerplate.
						Jump from screen to screen.
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#26bd26"
				>
					
					<p><label for="basic-url">Some big form standig in your way</label><a id="superSpeedFill" style="margin-left: 30px" class="btn btn-primary btn-lg" role="button"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>Fill Form</a></p>
					
					<div id="superSpeedForm">
						<div class="input-group">
						  <span class="input-group-addon" id="basic-addon1">@</span>
						  <input id="superSpeedFormUsername" type="text" class="form-control" placeholder="Username" aria-describedby="basic-addon1">
						</div>

						<div class="input-group">
						  <input id="superSpeedFormEmail" type="text" class="form-control" placeholder="Contact email" aria-describedby="basic-addon2">
						  <span class="input-group-addon" id="basic-addon2">@example.com</span>
						</div>


						<div class="input-group">
						  <span class="input-group-addon" id="basic-addon3">Plan</span>
						  <input id="superSpeedFormPlan" type="text" class="form-control" id="basic-url" placeholder="Something" aria-describedby="basic-addon3">
						</div>
						<a style="margin-left: 30px" class="btn btn-primary btn-lg" role="button">Save</a>
					</div>
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#dede38"
				>
					Super-vision
					<!--
						You need to be able to see what is happening on production.
						Add endpoints that allow you to query basic stuff.
						Add views that are not present on the regular version of the app using extensions.
						Browse information integrated with the very ui user uses to input it.
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#dede38"
				>
					Super-vision
					<a id="enableSuperVision" style="margin-left: 30px" class="btn btn-primary btn-lg" role="button"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>Enable superpowers</a>
					<div id="superVisionForm">
						<ul class="list-group">
						  <li class="list-group-item">
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Seller:</button>
							  <button type="button" class="btn btn-default">Dan</button>
							</div>
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Client list:</button>
							  <button type="button" class="btn btn-default">Alice, Bob, Carol</button>
							</div>
						  </li>
						</ul>
						<ul id="superVisionMetadata" style="display: none" class="list-group">
						  <li class="list-group-item">
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Present on last store report:</button>
							  <button type="button" class="btn btn-default">True</button>
							</div>
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Has apply discount permissions:</button>
							  <button type="button" class="btn btn-default">False</button>
							</div>
						  </li>
						</ul>
					</div>
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#dede38"
				>
					Super-vision
					<pre><code data-trim>
					await DEV.getSalesUntilDate("2019-02-02")
					  .then(cs => cs.map( c => c.articles ))
					  .then(as => as.flat())
					  .then(as => as.map( as => as.price ))
					  .then(ps => ps.reduce( (a, b) => a + b, 0 ) )
					</code></pre>
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#36bbbb"
				>
					Super-strength
					<!--
						Sometimes, you need to be able to change stuff on production, even if it is dangerous.
						Make yourself able to do this without burocracy.
					-->
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#36bbbb"
				>
					Super-strength <a id="enableSuperStrength" style="margin-left: 30px" class="btn btn-primary btn-lg" role="button"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>Enable superpowers</a>
					<div id="superStrengthForm">
						<ul class="list-group">
						  <li class="list-group-item">
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Seller:</button>
							  <button type="button" class="btn btn-default">Dan</button>
							</div>
							<div class="btn-group" role="group" aria-label="...">
							  <button type="button" class="btn btn-default">Client list:</button>
							  <button id="clientList" type="button" style="color: gray" class="btn btn-default">Alice, Bob, Carol</button>
							  <button style="display: none" id="editClientList" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>Edit List</button>
							</div>
						  </li>
						</ul>
					</div>
				</section>
				</section>
				<section
					data-expected-duration="5m"
					data-background-color="#36bbbb"
				>
					Super-strength
					<pre><code data-trim>
						DEV.addSaleToClient(clientName, article, price)
				    </code></pre>
				
				</section>
				<section
					data-expected-duration="2m"
					data-background-color="#b11818"
				>
					Just another tool on your toolbelt
				</section>
				<section
					data-expected-duration="2m"
					data-background-color="#2222b9"
				>
					Share your power
				</section>
			</div>
		</div>

		<script src="js/reveal.js"></script>

		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				controls: false,
				progress: false,
				hash: true,
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});

			//This code adds a subtle (i hope so) line over the slides
			//when the expectedDuration is up, the line changes color
			const timeInMinutes = 35

			let startTime = 0
			let intervalId = -1
			const timer = document.getElementById("timer")

			Reveal.addEventListener( 'slidechanged', function( event ) {
				//console.log(event)
				if(event.currentSlide.dataset["expectedDuration"]){
					const expectedDurationStr = event.currentSlide.dataset["expectedDuration"]
					let expectedDuration = 0
					if(expectedDurationStr.endsWith("s")){
						expectedDuration = parseInt(expectedDurationStr.split("s")[0])
					} else{
						expectedDuration = parseInt(expectedDurationStr.split("m")[0]) * 60
					}
					timer.style.display = "block"
					timer.style.backgroundColor= "#000000"
					if(intervalId) clearInterval(intervalId)
					startTime = new Date().getTime();

					intervalId = setInterval(() => {
					   const now = new Date().getTime();
					   const timePassedInSeconds = Math.floor( (now - startTime) / 1000 );
					   if(timePassedInSeconds >= expectedDuration) timer.style.backgroundColor= "#aaaaaa"
				   }, 500);
				}else{
					timer.style.display = "none"
				}
			} );
			
			let expectedTotalTime = Array.from(document.querySelectorAll(".slides section"))
			  .map(s => s.dataset["expectedDuration"])
			  .filter(d => d != null)
			  .map(d => d.endsWith("s") ? parseInt(d.split("s")[0]) : parseInt(d.split("m")[0]) * 60)
			  .reduce((a,b) => a + b, 0)
			
			console.log(`Expected duration: ${expectedTotalTime/60} minutes`)
			//slide code, this part would be he extension part
			let superSpeedFill = document.getElementById("superSpeedFill")
			superSpeedFill.addEventListener("click", () =>{
				document.getElementById("superSpeedFormUsername").value = "Alice"
				document.getElementById("superSpeedFormEmail").value = "alice"
				document.getElementById("superSpeedFormPlan").value = "SuperDuperDiscountPlan"
				setTimeout(() => {
					document.getElementById("superSpeedForm").innerHTML = "You can continue now"
				}, 1000 )
			});

			let enableSuperVision = document.getElementById("enableSuperVision")
			enableSuperVision.addEventListener("click", () =>{
				document.getElementById("superVisionMetadata").style.display = "block"
			});

			let editClientList = document.getElementById("editClientList")
			editClientList.addEventListener("click", () =>{
				document.getElementById("clientList").contentEditable = true
				document.getElementById("clientList").spellcheck = false
				document.getElementById("clientList").style.color = "black"
			});

			let enableSuperStrength = document.getElementById("enableSuperStrength")
			enableSuperStrength.addEventListener("click", () =>{
				document.getElementById("editClientList").style.display = "block"
			});


			//Pretend this data comes from your rest api ;)
			let backendState = [
				{
					"client": "Alice",
					"articles": [
						{
							"name": "computer",
							"price": 1200
						},
						{
							"name": "mouse",
							"price": 10
						},
						{
							"name": "keyboard",
							"price": 30
						}
					]
				},
				{
					"client": "Bob",
					"articles": [
						{
							"name": "monitor",
							"price": 200
						},
						{
							"name": "chair",
							"price": 80
						}
					]
				},
				{
					"client": "Carol",
					"articles": [
						{
							"name": "monitor",
							"price": 200
						},
						{
							"name": "chair",
							"price": 80
						}
					]
				}
			]

			let DEV = {
				getSalesUntilDate : () => Promise.resolve(backendState),
				addSaleToClient : (clientName, articleName, price) => {
					let clientWithArticles = backendState.find(c => c.client == clientName)
					clientWithArticles.articles.push(
						{name: articleName, price}
					)
				},
				showArticlesForClient : (clientName) => {
					console.table(
						backendState.find(c => c.client == clientName).articles
					)
				},
				showWeekInSales : () => {
					let c = document.createElement("canvas")
					c.style.display = "none"
					c.width = 1000
					var ctx = c.getContext("2d");
					ctx.fillStyle = "white"
					ctx.fillRect(0, 0, 500, 500);
					ctx.moveTo(0, 100);
					ctx.lineTo(100, 50);
					ctx.stroke();
					ctx.lineTo(200, 100);
					ctx.stroke();
					ctx.lineTo(300, 30);
					ctx.stroke();
					ctx.lineTo(400, 10);
					ctx.stroke();
					let pngUrl = c.toDataURL();
					console.log("%c       ", `font-size: 100px; background: url(${pngUrl}) no-repeat`)
				}
			}

		</script>
	</body>
</html>
